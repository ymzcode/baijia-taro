var eventEmitter=require("../../eventEmitter"),Queue=require("../../Queue"),appLanguage=require("../../language/main")(),pageLanguage=require("./language/main")(),$=require("../../jquery"),store=require("../../store");$.extend(pageLanguage,appLanguage),Component({properties:{styleInfo:{type:"Object",value:{showInfo:!0,strokeWidth:6,activeColor:"#1694ff",backgroundColor:"#d8d9d8"}}},data:{needHelp:!1,progress:0,statusTips:"",logoSrc:"",roomLoadEnded:!1},ready:function(){var e=this,a=new Queue({task:function(e,a){e.callback&&e.callback(e),a()}});e.queue=a,e.namespace=".loading"+Math.random();var t=0;eventEmitter.one(eventEmitter.INTERFACE_FETCH_SUCCESS+e.namespace,function(){e.setData({logoSrc:store.get("partner.logoPrefix")+"/m-loading.png"}),a.add({progress:20*++t,callback:function(a){e.setData({statusTips:pageLanguage.ENTER_DATA_SERVER_FETCH_SUCCESS,progress:a.progress})}})}).one(eventEmitter.INTERFACE_FETCH_FAIL+e.namespace,function(n,s){a.add({progress:20*++t,callback:function(a){e.setData({statusTips:s.msg,progress:a.progress})}})}).one(eventEmitter.MASTER_SERVER_CONNECT_SUCCESS+e.namespace,function(){a.add({progress:20*++t,callback:function(a){e.setData({statusTips:pageLanguage.ENTER_CLASSROOM_MASTER_SERVER_CONNECT_SUCCESS,progress:a.progress})}})}).one(eventEmitter.SERVER_INFO_FETCH_SUCCESS+e.namespace,function(){a.add({progress:20*++t,callback:function(a){e.setData({statusTips:pageLanguage.ENTER_CLASSROOM_SERVER_INFO_FETCH_SUCCESS,progress:a.progress})}})}).one(eventEmitter.ROOM_SERVER_CONNECT_SUCCESS+e.namespace,function(){a.add({progress:20*++t,callback:function(a){e.setData({statusTips:pageLanguage.ENTER_CLASSROOM_ROOM_SERVER_CONNECT_SUCCESS,progress:a.progress})}})}).one(eventEmitter.ROOM_SERVER_LOGIN_SUCCESS+e.namespace,function(){a.add({progress:20*++t,callback:function(a){e.setData({statusTips:pageLanguage.ENTER_CLASSROOM_ROOM_SERVER_LOGIN_SUCCESS,progress:a.progress,roomLoadEnded:!0}),setTimeout(function(){e.triggerEvent("loadEnded")},0)}})}).one(eventEmitter.ROOM_SERVER_LOGIN_FAIL+e.namespace,function(t,n){a.add({callback:function(a){e.setData({statusTips:pageLanguage.ENTER_CLASSROOM_ROOM_SERVER_LOGIN_FAIL,needHelp:!0})}})}).one(eventEmitter.ROOM_SERVER_LOGIN_OVERFLOW+e.namespace,function(t,n){a.add({callback:function(a){e.setData({statusTips:pageLanguage.ENTER_CLASSROOM_ROOM_SERVER_LOGIN_OVERFLOW,needHelp:!0})}})}).one(eventEmitter.ROOM_SERVER_LOGIN_KICKED_OUT+e.namespace,function(t,n){a.add({callback:function(a){e.setData({statusTips:pageLanguage.ENTER_CLASSROOM_ROOM_SERVER_LOGIN_KICKED_OUT,needHelp:!0})}})}).one(eventEmitter.CLASSROOM_CONNECT_FAIL+e.namespace,function(){a.add({callback:function(a){e.setData({statusTips:pageLanguage.ENTER_CLASSROOM_TIMEOUT_FAIL,needHelp:!0})}})})},beforeDestroy:function(){eventEmitter.off(this.namespace),this.queue.dispose()},methods:{}});