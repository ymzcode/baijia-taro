var config=require("../config"),store=require("../store"),camelCaseObject=require("../function/camelCaseObject"),util=require("../util");function formatClass(e){e.id=""+e.id,e.hasMoreUser=!0,e.startTime=util.toTimestamp(e.startTime,0),e.endTime=util.toTimestamp(e.endTime,0),e.mediaType=util.toNumber(e.mediaType,config.MEDIA_TYPE_VIDEO),e.playBuffer=util.toNumber(e.playBuffer,0),e.speakState=util.toNumber(e.speakState,config.SPEAK_STATE_FREE),e.liveAudioCodec=util.toNumber(e.liveAudioCodec,config.AUDIO_CODEC_AAC)}exports.getPartnerInfo=function(e){var a=e.data,t={};if(a.sign){var i=a.user;i.type=util.toNumber(i.type),i.status=util.toNumber(i.status,config.USER_STATUS_ONLINE),i.group=util.toNumber(i.group,config.NONE_GROUP_ID),i.number=""+i.number,i.actualName||(i.actualName=i.name),null==i.endType&&(i.endType=config.END_TYPE_WEIXIN_XIAOCHENGXU),a.class?formatClass(a.class):a.class={},a.userState={},t={room_id:a.class.id,user_number:i.number,user_name:i.name,user_avatar:i.avatar,user_role:i.type,sign:a.sign};var s=store.get("apiOrigin")+config.SDK_PARTNER_INFO_REQUEST_PATH}else{t={code:a.code,user_name:a.nickName,user_avatar:a.userAvatar};s=store.get("apiOrigin")+config.PARTNER_INFO_REQUEST_PATH}wx.request({url:s,data:t,success:function(a){0==(a=camelCaseObject(a)).data.code?e.onsuccess&&e.onsuccess(a):e.onfail&&e.onfail(a)},fail:function(a){e.onfail&&e.onfail(camelCaseObject(a))}})},exports.checkQuestionnaire=function(e){var a=store.get("apiOrigin")+config.CHECK_QUESTIONNAIRE_PATH;wx.request({url:a,data:{room_id:e.roomId,token:e.token,uuid:e.uuid},success:function(a){var t=camelCaseObject(a.data).data.isNeedFill;e.onsuccess&&e.onsuccess(t)},fail:function(a){e.onfail&&e.onfail()}})};